**JPA 매핑 어노테이션**

- 객체와 테이블 매핑: @Entity, @Table
- 기본 키 매핑: @Id
- 필드와 컬럼 매핑: @Column
- 연관관계 매핑: @ManyToOne, @JoinColumn

<br>

### 4.1 @Entity

- JPA를 사용해 테이블과 매핑할 클래스는 @Entity 어노테이션 필수
- name: JPA에서 사용할 엔티티 이름 지정
- 기본 생성자 필수
- final, enum, interface, inner 클래스 사용 불가
- 저장할 필드에 final 사용 불가

<br>

### 4.2 @Table
| 속성 | 기능 | 기본값 |
| --- | --- | --- |
| name | 매핑할 테이블 이름 | 엔티티 이름 사용 |
| catalog | catalog 기능이 있는 데이터베이스에서 catalog 매핑 |  |
| schema | schema 기능이 있는 데이터베이스에서 schema 매핑 |  |
| uniqueConstraints | DDL 생성 시 유니크 제약 조건 만듦. 스키마 자동생성 기능을 사용해 DDL을 만들 때만 사용 |  |

<br>

### 4.3 다양한 매핑 사용

[ 요구사항 ]

1. 회원은 일반 회원과 관리자로 구분
2. 회원 가입일과 수정일 존재
3. 회원을 설명할 수 있는 필드 필요. 필드 길이 제한 X

```java
@Entity
@Table(name = "MEMBER")
public class Member{
	@Id
	@Column(name = "ID")
	private String id;

	@Column(name = "NAME")
	private String username;

	private Integer age;

	// == 추가 ==
	@Enumerated(EnumType.STRING)
	private RoleType roleType; // enum을 이용해 회원 타입 구분, enum 사용 시 @Enumerated 어노테이션 매핑 필요

	@Temporal(TemporalType.TIMESTAMP)
	private Date createdDate; // 자바 날짜 타입은 @Temporal

	@Temporal(TemporalType.TIMESTAMP)
	private Date lastModifiedDate; // 자바 날짜 타입은 @Temporal

	@Lob
	private String description; // 길이 제한 X -> VARCHAR 타입 대신 CLOB 타입 저장 필요. ==> @Lob 사용 시 CLOB. BLOB 타입 매핑 가능

	// Getter, Setter, ...
}
```

```java
public enum RoleType{
	ADMIN, USER
}
```

<br><br>

### 4.4 데이터베이스 스키마 자동 완성

JPA는 데이터베이스 스키마 자동 생성 기능 지원

```xml
<property name="hibernate.hbm2ddl.auto" value="create" /> 

<property name="hibernate.show_sql" value="true" /> // 콘솔에 ddl 출력
```

- 애플리케이션 실행 시점에 데이터베이스 테이블 자동 생성

<br>

| 옵션 | 설명 |
| --- | --- |
| create | 기존 테이블을 삭제하고 새로 생성 DROP + CREATE |
| create-drop | create 속성에 추가로 애플리케이션을 종료할 때 DDL 제거. DROP + CREATE + DROP |
| update | 데이터베이스 테이블과 엔티티 매핑정보를 비교해서 변경 사항만 수정 |
| validate | 데이터베이스 테이블과 엔티티 매핑정보를 비교해서 차이가 있으면 경고 + 애플리케이션 실행 X. DDL 수정 안 함 |
| none | 자동 생성 기능을 사용하지 않음 |

- 개발 초기 단계: create, update
- 초기화 상태로 자동화된 테스트를 진행하는 개발자 환경과 CI서버: create, create-drop
- 테스트 서버: update, validate
- 스테이징과 운영 서버: validate, none

```xml
<property name="hibernate.ejb.naming_strategy" value="org.hibernate.cfg.ImprovedNamingStrategy" />
```

- 테이블 명이나 컬럼 명이 생략 → 자바의 카멜 표기법을 테이블의 언더스코어 표기법으로 매핑

<br><br>

### 4.5 DDL 생성 기능
